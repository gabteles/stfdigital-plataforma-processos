sudo: required
language: java
jdk:
- oraclejdk8
services:
- docker
addons:
  hosts:
  - docker
before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
- docker save -o $HOME/docker_cache/docker.tar stfdigital-plataforma-services $(docker history -q stfdigital-plataforma-services | tail -n +2 | grep -v \<missing\> | tr '\n' ' ')
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - node_cache
  - node_modules
  - "$HOME/docker_cache"
before_install:
- "./scripts/upgrade-docker.sh"
- mkdir -p $HOME/docker_cache
install: docker load -i $HOME/docker_cache/docker.tar || true
script: gradle docker && gradle gulpTestUnit && ./scripts/test-e2e.sh
notifications:
  slack:
    secure: vf5J+aqTlJsi3xM1lhRrNcTPshtHmAU/qOOqTah2OyRNroKtBXDbkerhop4U6xmSpxe5LhDGTXMTgjN6V3QXRpAi77WycNhxoUmdUWY4pNyiDBhVN6ejZD0/IRQH53Rfbk1o/akKH0fWhNAc+sXxgojTcTmgwUOfS66WY1XZrKZ8s6qfw/u+Ki5ejuijtpKvHDZA1EaWczoFYpujCQSnj1dH8Q4YZIN0OxuKuoKCHrWCT0UTEmDdEBP4HJb02XQgfEb+g8v4TvOMd+p0kmSftasetfy/oU+f5QVXV3oeNF3qKqCNfvvxQ7Iqpbl3QjXmlSNf1BbZCtw3xVksfpRjfrT4NS1lMbBDPOgALQMO//e+nvNb0C2Luo7NJZ2/zTKfKeZoou92bM79azoibLYupoaUm2a/OwEdqCFzubWZvB5TI+yuumuFVPTSiDeK4jwtIF3FqgXKfvsHDX1GAbcZAf15Rd1ljzg7vVIeTn+bFj0OCfgTiRb/ym7Zehy2fxkg6bUwQz+tHFGOrnKl5MyCcY+NjEGreJ8IUpdUClfJu5KS9jNEmbSNEeK8eE+wOXneNAM6UGSpZiBKLkYC0ZhE54Z9DFV0qXbfVMmCpvErR2J1T5QB01mucTnx0cQmJs3j6j4x7FrlVnqxvI5uStTkz4To148+WaAbcmaHCuhFSAY=
